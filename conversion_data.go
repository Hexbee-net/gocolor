// Copyright Â© 2019 Xavier Basty <xavier@hexbee.net>
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package gocolor

var conversionRgbXyz = map[string]matrix{
	AdobeRGB: {
		0.5767309, 0.1855540, 0.1881852,
		0.2973769, 0.6273491, 0.0752741,
		0.0270343, 0.0706872, 0.9911085,
	},
	AppleRGB: {
		0.4497288, 0.3162486, 0.1844926,
		0.2446525, 0.6720283, 0.0833192,
		0.0251848, 0.1411824, 0.9224628,
	},
	BestRGB: {
		0.6326696, 0.2045558, 0.1269946,
		0.2284569, 0.7373523, 0.0341908,
		0.0000000, 0.0095142, 0.8156958,
	},
	BetaRGB: {
		0.6712537, 0.1745834, 0.1183829,
		0.3032726, 0.6637861, 0.0329413,
		0.0000000, 0.0407010, 0.7845090,
	},
	BruceRGB: {
		0.4674162, 0.2944512, 0.1886026,
		0.2410115, 0.6835475, 0.0754410,
		0.0219101, 0.0736128, 0.9933071,
	},
	BT2020: {
		0.636958048301291, 0.144616903586208, 0.168880975164172,
		0.262700212011267, 0.677998071518871, 0.059301716469862,
		0.000000000000000, 0.028072693049087, 1.060985057710791,
	},
	BT202012b: {
		0.636958048301291, 0.144616903586208, 0.168880975164172,
		0.262700212011267, 0.677998071518871, 0.059301716469862,
		0.000000000000000, 0.028072693049087, 1.060985057710791,
	},
	CieRGB: {
		0.4887180, 0.3106803, 0.2006017,
		0.1762044, 0.8129847, 0.0108109,
		0.0000000, 0.0102048, 0.9897952,
	},
	ColorMatchRGB: {
		0.5093439, 0.3209071, 0.1339691,
		0.2748840, 0.6581315, 0.0669845,
		0.0242545, 0.1087821, 0.6921735,
	},
	DonRGB4: {
		0.6457711, 0.1933511, 0.1250978,
		0.2783496, 0.6879702, 0.0336802,
		0.0037113, 0.0179861, 0.8035125,
	},
	EciRGB: {
		0.6502043, 0.1780774, 0.1359384,
		0.3202499, 0.6020711, 0.0776791,
		0.0000000, 0.0678390, 0.7573710,
	},
	EktaSpacePS5: {
		0.5938914, 0.2729801, 0.0973485,
		0.2606286, 0.7349465, 0.0044249,
		0.0000000, 0.0419969, 0.7832131,
	},
	NtscRGB: {
		0.6068909, 0.1735011, 0.2003480,
		0.2989164, 0.5865990, 0.1144845,
		0.0000000, 0.0660957, 1.1162243,
	},
	PalSecamRGB: {
		0.4306190, 0.3415419, 0.1783091,
		0.2220379, 0.7066384, 0.0713236,
		0.0201853, 0.1295504, 0.9390944,
	},
	ProPhotoRGB: {
		0.7976749, 0.1351917, 0.0313534,
		0.2880402, 0.7118741, 0.0000857,
		0.0000000, 0.0000000, 0.8252100,
	},
	SmptecRGB: {
		0.3935891, 0.3652497, 0.1916313,
		0.2124132, 0.7010437, 0.0865432,
		0.0187423, 0.1119313, 0.9581563,
	},
	SRGB: {
		0.4124564, 0.3575761, 0.1804375,
		0.2126729, 0.7151522, 0.0721750,
		0.0193339, 0.1191920, 0.9503041,
	},
	WideGamutRGB: {
		0.7161046, 0.1009296, 0.1471858,
		0.2581874, 0.7249378, 0.0168748,
		0.0000000, 0.0517813, 0.7734287,
	},
}

var conversionXyzRgb = map[string]matrix{
	AdobeRGB: {
		2.0413690, -0.5649464, -0.3446944,
		-0.9692660, 1.8760108, 0.0415560,
		0.0134474, -0.1183897, 1.0154096,
	},
	AppleRGB: {
		2.9515373, -1.2894116, -0.4738445,
		-1.0851093, 1.9908566, 0.0372026,
		0.0854934, -0.2694964, 1.0912975,
	},
	BestRGB: {
		1.7552599, -0.4836786, -0.2530000,
		-0.5441336, 1.5068789, 0.0215528,
		0.0063467, -0.0175761, 1.2256959,
	},
	BetaRGB: {
		1.6832270, -0.4282363, -0.2360185,
		-0.7710229, 1.7065571, 0.0446900,
		0.0400013, -0.0885376, 1.2723640,
	},
	BruceRGB: {
		2.7454669, -1.1358136, -0.4350269,
		-0.9692660, 1.8760108, 0.0415560,
		0.0112723, -0.1139754, 1.0132541,
	},
	BT2020: {
		1.716651187971269, -0.355670783776393, -0.253366281373660,
		-0.666684351832489, 1.616481236634939, 0.015768545813911,
		0.017639857445311, -0.042770613257809, 0.942103121235474,
	},
	BT202012b: {
		1.716651187971269, -0.355670783776393, -0.253366281373660,
		-0.666684351832489, 1.616481236634939, 0.015768545813911,
		0.017639857445311, -0.042770613257809, 0.942103121235474,
	},
	CieRGB: {
		2.3706743, -0.9000405, -0.4706338,
		-0.5138850, 1.4253036, 0.0885814,
		0.0052982, -0.0146949, 1.0093968,
	},
	ColorMatchRGB: {
		2.6422874, -1.2234270, -0.3930143,
		-1.1119763, 2.0590183, 0.0159614,
		0.0821699, -0.2807254, 1.4559877,
	},
	DonRGB4: {
		1.7603902, -0.4881198, -0.2536126,
		-0.7126288, 1.6527432, 0.0416715,
		0.0078207, -0.0347411, 1.2447743,
	},
	EciRGB: {
		1.7827618, -0.4969847, -0.2690101,
		-0.9593623, 1.9477962, -0.0275807,
		0.0859317, -0.1744674, 1.3228273,
	},
	EktaSpacePS5: {
		2.0043819, -0.7304844, -0.2450052,
		-0.7110285, 1.6202126, 0.0792227,
		0.0381263, -0.0868780, 1.2725438,
	},
	NtscRGB: {
		1.9099961, -0.5324542, -0.2882091,
		-0.9846663, 1.9991710, -0.0283082,
		0.0583056, -0.1183781, 0.8975535,
	},
	PalSecamRGB: {
		3.0628971, -1.3931791, -0.4757517,
		-0.9692660, 1.8760108, 0.0415560,
		0.0678775, -0.2288548, 1.0693490,
	},
	ProPhotoRGB: {
		1.3459433, -0.2556075, -0.0511118,
		-0.5445989, 1.5081673, 0.0205351,
		0.0000000, 0.0000000, 1.2118128,
	},
	SmptecRGB: {
		3.5053960, -1.7394894, -0.5439640,
		-1.0690722, 1.9778245, 0.0351722,
		0.0563200, -0.1970226, 1.0502026,
	},
	SRGB: {
		3.2404542, -1.5371385, -0.4985314,
		-0.9692660, 1.8760108, 0.0415560,
		0.0556434, -0.2040259, 1.0572252,
	},
	WideGamutRGB: {
		1.4628067, -0.1840623, -0.2743606,
		-0.5217933, 1.4472381, 0.0677227,
		0.0349342, -0.0968930, 1.2884099,
	},
}

var (
	conversionXyzLms = matrix{
		0.4002, 0.7075, -0.0807,
		-0.2280, 1.1500, 0.0612,
		0.0000, 0.0000, 0.9184,
	}
	conversionLmsIpt = matrix{
		0.4000, 0.4000, 0.2000,
		4.4550, -4.8510, 0.3960,
		0.8056, 0.3572, -1.1628,
	}
)

var (
	conversionIptLms = matrix{
		1., 0.0975689, 0.205226,
		1., -0.113876, 0.133217,
		1, 0.0326151, -0.676887,
	}
	conversionLmsXyz = matrix{
		1.85024, -1.1383, 0.238435,
		0.366831, 0.643885, -0.0106734,
		0, 0, 1.08885,
	}
)

var (
	conversionRgbYiq = matrix{
		0.29895808, 00.58660979, 00.11443213,
		0.59590296, -0.27405705, -0.32184591,
		0.21133576, -0.52263517, 00.31129940,
	}
	conversionYiqRgb = matrix{
		1, 00.9562, 00.621,
		1, -0.2717, -0.6485,
		1, -1.1053, 01.702,
	}
)

var (
	conversionRgbSDYuv = matrix{
		00.29900, 00.58700, 00.11400,
		-0.14713, -0.28886, 00.43600,
		00.61500, -0.51499, -0.10001,
	}
	conversionSDYuvRgb = matrix{
		01.00000, 00.00000, 01.13983,
		01.00000, -0.39465, -0.58060,
		01.00000, 02.03211, 00.00000,
	}
	conversionRgbHDYuv = matrix{
		00.21260, 00.71520, 0.07220,
		-0.09991, -0.33609, 0.43600,
		00.61500, -0.55861, 0.05639,
	}
	conversionHDYuvRgb = matrix{
		01.00000, 00.00000, 01.28033,
		01.00000, -0.21482, -0.38059,
		01.00000, 02.12798, 00.00000,
	}
)

const (
	ChromaBradford   = "bradford"   // Bradford
	ChromaVonKries   = "vonkries"   // von Kries
	ChromaSharp      = "sharp"      // Sharp - based on sharpened sensors, min. XYZ errors
	ChromaCMCCAT2000 = "cmccat2000" // CMCCAT2000 - fitted from all available color data sets
	ChromaCAT02      = "cat02"      //CAT02 - optimized for minimizing CIELAB differences
	ChromaXYZ        = "xyz"        // XYZ scaling
)

// https://web.stanford.edu/~sujason/ColorBalancing/Papers/Two%20New%20von%20Kries%20Based%20Chromatic%20Adaptation.pdf
var chromaticAdaptation = map[string]matrix{
	ChromaBradford: {
		0.8951, 0.2664, -0.1614,
		-0.7502, 1.7135, 0.0367,
		0.0389, -0.0685, 1.0296,
	},
	ChromaVonKries: {
		0.40024, 0.70760, -0.08081,
		-0.22630, 1.16532, 0.04570,
		0.00000, 0.00000, 0.91822,
	},
	ChromaSharp: {
		1.2694, -.0988, -.1706,
		-0.8364, 1.8006, 0.0357,
		0.0297, -0.0315, 1.0018,
	},
	ChromaCMCCAT2000: {
		0.7982, 0.3389, -0.1371,
		-0.5918, 1.5512, 0.0406,
		0.0008, 0.239, 0.9753,
	},
	ChromaCAT02: {
		0.7328, 0.4296, -0.1624,
		-0.7036, 1.6975, 0.0061,
		0.0030, 0.0136, 0.9834,
	},
	ChromaXYZ: {
		1, 0, 0,
		0, 1, 0,
		0, 0, 1,
	},
}

var chromaticAdaptationInverse = map[string]matrix{
	ChromaBradford: {
		0.986993, -0.147054, 0.159963,
		0.432305, 0.51836, 0.0492912,
		-0.00852866, 0.0400428, 0.968487,
	},
	ChromaVonKries: {
		1.85994, -1.12938, 0.219897,
		0.361191, 0.638812, -0.000006,
		0, 0, 1.08906,
	},
	ChromaSharp: {
		0.815633, 0.0471548, 0.137217,
		0.379114, 0.576942, 0.0440009,
		-0.0122601, 0.0167431, 0.995519,
	},
	ChromaCMCCAT2000: {
		1.0623, -0.256743, 0.160018,
		0.40792, 0.550236, 0.0344369,
		-0.100833, -0.134626, 1.01676,
	},
	ChromaCAT02: {
		1.09612, -0.278869, 0.182745,
		0.454369, 0.473533, 0.0720978,
		-0.00962761, -0.00569803, 1.01533,
	},
	ChromaXYZ: {
		1, 0, 0,
		0, 1, 0,
		0, 0, 1,
	},
}
